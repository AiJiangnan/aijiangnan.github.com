<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <script src="../../../js/markdown.js"></script>
    <script src="../../../js/jquery.min.js"></script>

    <link rel="stylesheet" href="../../../css/content.css">
    <title>事务管理</title>
</head>

<body>
    <textarea hidden id="content">
<!--Markdown从这里开始  -->
# 事务管理

## 一、事务的概念

事务是一个操作序列，这些操作要么都做，要么都不做，是一个不可分割的工作单位，是数据库中的逻辑工作单位。

## 二、事务的操作

模拟很行转账操作：

```sql
-- 创建银行用户表
CREATE TABLE t_account (
       aid NUMBER(5) PRIMARY KEY,
       aname VARCHAR(20) NOT NULL,
       amoney NUMBER(7,2)
);
SELECT * FROM t_account;
-- 插入数据
INSERT INTO t_account VALUES (10001,'张三',5000);
INSERT INTO t_account VALUES (10002,'李四',5100);
-- 转账操作
UPDATE t_account SET amoney=amoney-1000 WHERE aid=10001;
UPDATE t_account SET amoney=amoney+1000 WHERE aid=10002;
-- 提交事务
COMMIT;
-- 回滚事务
ROLLBACK;
```

说明：只有转账操作全部执行成功才需要提交事务，否则回滚操作。

**事务结束于以下几种情况：**

- 用户执行COMMIT语句提交操作或ROLLBACK语句回退。
- 当执行DDL（CREATE、ALTER、DROP）语句事务自动提交。
- 用户正常断开连接时，TRANSACTION自动提交。
- 系统崩溃或断电时事务自动回退。

<!--Markdown从这里结束  -->
	</textarea>
    <div id="preview" class="container"></div>
    <script>
        $("#preview").html(marked($("#content").val()));
        $("table").addClass("table table-bordered table-striped");
    </script>
</body>

</html>